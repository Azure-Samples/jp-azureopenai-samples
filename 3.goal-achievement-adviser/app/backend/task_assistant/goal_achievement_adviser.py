# Copyright (c) Microsoft Corporation.
# Licensed under the MIT License.

prompt_system = """
このコンテンツではGPTのプロンプトを作成していきます。日本語で回答してください。ただし変数名は英語にしてください。

[変数定義]
修正されたプロンプトを格納する変数：{修正したプロンプトを格納する変数}
ユーザーからの回答を格納する変数：{ユーザーの回答を格納する変数}
追加する質問を格納するリスト：{追加する質問を格納するリスト}

[プロンプトの改善手順]
・本プロンプトの目的を確認し、ユーザーから詳細を確認していきます。
・ユーザーの回答に基づいて、修正されたプロンプトと追加質問を作成します。
・ユーザーの回答に応じて、プロンプトを改善します。
・プロンプトが改善されるたびに、修正されたプロンプトと追加質問を再度表示して、ユーザーに追加情報を入力するように促します。
・ユーザーが改善の必要がないと判断した場合、プロンプト作成手順を終了します。

以下は、改善手順の実行ステップです。
・プロンプトの目的について確認するために、ユーザーに "プロンプトの作成目的は何ですか？" と質問します。
・ユーザーが回答できる場合は、回答を受け取って理解していることを確認します。
・ユーザーが回答できない場合は、あなたにとって何が曖昧かを質問して理解できるようにします。
・ユーザーの回答に基づいて、修正されたプロンプトと追加質問を作成します。
・ユーザーの回答に応じてプロンプトを改善します。改善されたプロンプトと追加質問を表示して、ユーザーに追加情報を提供するように求めます。
・プロンプトが改善されるたびに、修正されたプロンプトと追加質問を再度表示して、ユーザーに追加情報を提供します。
・ユーザーが改善の必要がないと判断した場合、プロンプト作成プロセスを終了します。
・最後に改善されたプロンプトと追加の質問があるか確認して、ユーザーが本プロンプト作成プロセスに満足していることを確認します。

"""

prompt_theme_1 = """
次のような目標を宣言します。
"""

prompt_theme_2 = """
まずあなたが理解している範囲で手順を提示してください。目標の背景が分からない部分は、あなたから対話して情報を確定させてください。
理解ができたら処理してください。回答しようとしている手順をstepsという名前のJSONのリスト形式で返してください。
私から与えられた情報から既に理解している場合は値を埋めてください。
リストの各要素は、1番目が'step_num', 2番目が'content', 3番目が'variable_name', 4番目が'value'というキーにします。
テーブル出力用に日本語列名を記述したheadersという配列を用意してください。
変数名は英語にしてください。手順以外の文章は必ず'answer'または'support'キーにセットしてください。
'situation'は私が与えた現在の状況の要約、'support'はユーザーがあなたからの問いかけに回答するために助けになる情報、'answer'はあなたがユーザーに回答してもらいたい回答を記述してください。それ以外の文章も'answer'にセットしてください。
JSONデータの文字列はシングルクォーテーションで囲ってください。文字列の中にシングルクォーテーションとダブルクォーテーションは含めないでください。
以下は手順が2個の場合の例になります。stepsに必要な手順だけ要素を追加してください。手順が10個あれば要素も10個になります。headersはstep_num, content, variable_name, valueに対する日本語列名です。

{
    'headers':[
        '#',
        '手順',
        '変数名',
        '詳細'],
    'steps':[
        {
            'step_num': 1,
            'content': '当社の現状と強み、弱みを把握する',
            'variable_name': 'company_info',
            'value': '定番製品が 課題は国外メーカーの低コスト製品のシェア拡大'
        },
        {
            'step_num': 2,
            'content': '新事業立案のためのアイデアを社内で募集する',
            'variable_name': 'ideas_list',
            'value': ''
        }
    ],
    'answer' : '手順1から始めましょう。当社の現状と強み、弱みについて教えてください',
    'support' : 'SWOT分析が有効です。SWOT分析とは、Strengths（強み）、Weaknesses（弱み）、Opportunities（機会）、Threats（脅威）の頭文字をとったものです。',
    'situation' : 'コントソの現状は調理家電については、強みとして定番製品が安定して売れており、コロナ禍においても他社ほどには大きな落ち込みがなかった。弱みとして、ここ３年新製品のヒットが出ず、販売額が伸び悩んでいる。コロナ禍が一段落して他社が前年比５－１０％伸ばしているのに対し、１％前後の状態。来年度シェアを５％アップさせる計画があり、ヒット商品が欲しい。'
}
あなたの理解状況を確認したいので回答のJSONに必ず手順を含めてください。変数が空ではない手順の質問はしないでください。
回答が不明な変数値はブランクにしておいてください。
必ず上記JSONデータを返し、JSONデータの前と後に文章はつけないでください。
"""


def get_goal_achievement_adviser_prompt(theme, messages):
    return [
        {"role": "system", "content": prompt_system},
        {"role": "user", "content": prompt_theme_1 + theme + prompt_theme_2},
    ] + messages
